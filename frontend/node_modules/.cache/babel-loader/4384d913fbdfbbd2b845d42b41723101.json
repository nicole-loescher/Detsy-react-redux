{"ast":null,"code":"import _regeneratorRuntime from\"/Users/nicolelolo/Desktop/authenticate-me/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/nicolelolo/Desktop/authenticate-me/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import{fetch}from'./csrf';var SET_USER='session/setUser';var REMOVE_USER='session/removeUser';var setUser=function setUser(user){return{type:SET_USER,payload:user};};var removeUser=function removeUser(){return{type:REMOVE_USER};};export var login=function login(user){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var credential,password,response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:credential=user.credential,password=user.password;_context.next=3;return fetch('/api/session',{method:'POST',body:JSON.stringify({credential:credential,password:password})});case 3:response=_context.sent;dispatch(setUser(response.data.user));return _context.abrupt(\"return\",response);case 6:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();};export var restoreUser=function restoreUser(){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var response;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return fetch('/api/session');case 2:response=_context2.sent;dispatch(setUser(response.data.user));return _context2.abrupt(\"return\",response);case 5:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}();};export var signup=function signup(user){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch){var username,email,password,response;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:username=user.username,email=user.email,password=user.password;_context3.next=3;return fetch('/api/users',{method:'post',headers:{'Content-Type':'application/json'},body:JSON.stringify({username:username,email:email,password:password})});case 3:response=_context3.sent;dispatch(setUser(response.data.user));return _context3.abrupt(\"return\",response);case 6:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x3){return _ref3.apply(this,arguments);};}();};export var logout=function logout(user){return/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(dispatch){var response;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return fetch('/api/session',{method:'delete'});case 2:response=_context4.sent;dispatch(removeUser());return _context4.abrupt(\"return\",response);case 5:case\"end\":return _context4.stop();}}},_callee4);}));return function(_x4){return _ref4.apply(this,arguments);};}();};var initialState={user:null};var sessionReducer=function sessionReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;var action=arguments.length>1?arguments[1]:undefined;var newState;switch(action.type){case SET_USER:newState=Object.assign({},state);newState.user=action.payload;return newState;case REMOVE_USER:newState=Object.assign({},state);newState.user=null;return newState;default:return state;}};export default sessionReducer;","map":{"version":3,"sources":["/Users/nicolelolo/Desktop/authenticate-me/frontend/src/store/session.js"],"names":["fetch","SET_USER","REMOVE_USER","setUser","user","type","payload","removeUser","login","dispatch","credential","password","method","body","JSON","stringify","response","data","restoreUser","signup","username","email","headers","logout","initialState","sessionReducer","state","action","newState","Object","assign"],"mappings":"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","sourcesContent":["import { fetch } from './csrf';\n\nconst SET_USER = 'session/setUser';\nconst REMOVE_USER = 'session/removeUser';\n\nconst setUser = (user) => {\n    return {\n        type: SET_USER,\n        payload: user,\n    };\n};\n\nconst removeUser = () => {\n    return {\n        type: REMOVE_USER,\n    };\n};\n\nexport const login = (user) => async (dispatch) => {\n    const { credential, password } = user;\n    const response = await fetch('/api/session', {\n        method: 'POST',\n        body: JSON.stringify({\n            credential,\n            password,\n        }),\n    });\n    dispatch(setUser(response.data.user));\n    return response;\n};\n\nexport const restoreUser = () => async dispatch => {\n    const response = await fetch('/api/session')\n    dispatch(setUser(response.data.user))\n    return response;\n};\nexport const signup = (user) => async dispatch => {\n    const { username, email, password } = user;\n    const response = await fetch('/api/users', {\n        method: 'post',\n        headers: {\n            'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n            username,\n            email,\n            password\n        })\n    })\n    dispatch(setUser(response.data.user));\n    return response;\n};\n\nexport const logout = user => async dispatch => {\n    const response = await fetch('/api/session', {\n        method: 'delete',\n    })\n    dispatch(removeUser());\n    return response;\n}\n\nconst initialState = { user: null };\n\nconst sessionReducer = (state = initialState, action) => {\n    let newState;\n    switch (action.type) {\n        case SET_USER:\n            newState = Object.assign({}, state);\n            newState.user = action.payload;\n            return newState;\n        case REMOVE_USER:\n            newState = Object.assign({}, state);\n            newState.user = null;\n            return newState;\n        default:\n            return state;\n    }\n};\n\nexport default sessionReducer;"]},"metadata":{},"sourceType":"module"}